{"ast":null,"code":"import React,{useState,useEffect}from'react';import TaskRow from'./TaskRow';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const EpicRow=_ref=>{let{epic,isExpanded,onToggleExpand,onDeleteTask,refreshTrigger}=_ref;const[tasks,setTasks]=useState([]);const[loadingTasks,setLoadingTasks]=useState(false);const[expandedTasks,setExpandedTasks]=useState(new Set());const navigate=useNavigate();const epicId=epic.id||epic.epicId||epic.taskId;useEffect(()=>{if(isExpanded&&tasks.length===0){fetchTasksForEpic();}},[isExpanded]);// Refetch tasks when refreshTrigger changes and epic is expanded\nuseEffect(()=>{if(isExpanded&&refreshTrigger>0){fetchTasksForEpic();}},[refreshTrigger]);const fetchTasksForEpic=async()=>{try{setLoadingTasks(true);console.log(\"Fetching tasks for epic \".concat(epicId,\"...\"));const response=await fetch(\"/tasks/epic/\".concat(epicId));if(!response.ok){throw new Error('Failed to fetch tasks for epic');}const epicTasks=await response.json();console.log(\"Found \".concat(epicTasks.length,\" tasks for epic \").concat(epicId,\":\"),epicTasks);setTasks(epicTasks);}catch(error){console.error('Error fetching tasks for epic:',error);setTasks([]);}finally{setLoadingTasks(false);}};const handleEpicClick=()=>{onToggleExpand(epicId);};const handleTaskToggle=taskId=>{const newExpanded=new Set(expandedTasks);if(newExpanded.has(taskId)){newExpanded.delete(taskId);}else{newExpanded.add(taskId);}setExpandedTasks(newExpanded);};const handleEdit=()=>{navigate(\"/edit-epic\",{state:{epic:epic}});};const handleDelete=()=>{onDeleteTask(epic);};const handleAddTask=()=>{navigate(\"/add-task/\".concat(epicId));};const getEpicTitle=()=>{return epic.title||epic.name||'Untitled Epic';};const getEpicType=()=>{return epic.type||'epic';};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"tr\",{className:\"epic-row\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"expand-column\",children:/*#__PURE__*/_jsx(\"button\",{className:\"expand-button \".concat(isExpanded?'expanded':''),onClick:handleEpicClick,title:isExpanded?'Collapse':'Expand',children:isExpanded?'▼':'▶'})}),/*#__PURE__*/_jsxs(\"td\",{className:\"epic-title\",children:[/*#__PURE__*/_jsx(\"strong\",{children:getEpicTitle()}),/*#__PURE__*/_jsx(\"button\",{onClick:handleAddTask,className:\"add-task-btn\",title:\"Add Task\",style:{marginLeft:'10px',fontSize:'14px',padding:'2px 6px'},children:\"+ Add Task\"})]}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"span\",{className:\"type-badge epic-badge\",children:getEpicType()})}),/*#__PURE__*/_jsx(\"td\",{children:epic.status||'Not Started'}),/*#__PURE__*/_jsx(\"td\",{children:epic.priority||'Medium'}),/*#__PURE__*/_jsx(\"td\",{children:epic.assigneeId||epic.assignedTo||'Unassigned'}),/*#__PURE__*/_jsx(\"td\",{children:epic.startDate}),/*#__PURE__*/_jsx(\"td\",{children:epic.endDate||epic.dueDate||'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"button-container\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleEdit,className:\"button-list edit-btn\",children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleDelete,className:\"button-list delete-btn\",children:\"Delete\"})]})})]}),isExpanded&&/*#__PURE__*/_jsx(_Fragment,{children:loadingTasks?/*#__PURE__*/_jsx(\"tr\",{className:\"loading-row\",children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"9\",className:\"loading-cell\",children:\"Loading tasks for epic...\"})}):tasks.length===0?/*#__PURE__*/_jsx(\"tr\",{className:\"empty-row\",children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"9\",className:\"empty-cell\",children:\"No tasks found under this epic.\"})}):tasks.map(task=>/*#__PURE__*/_jsx(TaskRow,{task:task,level:1,isExpanded:expandedTasks.has(task.id||task.taskId),onToggleExpand:handleTaskToggle,onDeleteTask:onDeleteTask,refreshTrigger:refreshTrigger},task.id||task.taskId))})]});};export default EpicRow;","map":{"version":3,"names":["React","useState","useEffect","TaskRow","useNavigate","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","EpicRow","_ref","epic","isExpanded","onToggleExpand","onDeleteTask","refreshTrigger","tasks","setTasks","loadingTasks","setLoadingTasks","expandedTasks","setExpandedTasks","Set","navigate","epicId","id","taskId","length","fetchTasksForEpic","console","log","concat","response","fetch","ok","Error","epicTasks","json","error","handleEpicClick","handleTaskToggle","newExpanded","has","delete","add","handleEdit","state","handleDelete","handleAddTask","getEpicTitle","title","name","getEpicType","type","children","className","onClick","style","marginLeft","fontSize","padding","status","priority","assigneeId","assignedTo","startDate","endDate","dueDate","colSpan","map","task","level"],"sources":["/home/abd_faiyaz/ontik_project_1/Gantt_project_v1/src/main/resources/static/React_Frontend/frontend/src/components/EpicRow.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport TaskRow from './TaskRow';\nimport { useNavigate } from 'react-router-dom';\n\nconst EpicRow = ({ epic, isExpanded, onToggleExpand, onDeleteTask, refreshTrigger }) => {\n  const [tasks, setTasks] = useState([]);\n  const [loadingTasks, setLoadingTasks] = useState(false);\n  const [expandedTasks, setExpandedTasks] = useState(new Set());\n  const navigate = useNavigate();\n\n  const epicId = epic.id || epic.epicId || epic.taskId;\n\n  useEffect(() => {\n    if (isExpanded && tasks.length === 0) {\n      fetchTasksForEpic();\n    }\n  }, [isExpanded]);\n\n  // Refetch tasks when refreshTrigger changes and epic is expanded\n  useEffect(() => {\n    if (isExpanded && refreshTrigger > 0) {\n      fetchTasksForEpic();\n    }\n  }, [refreshTrigger]);\n\n  const fetchTasksForEpic = async () => {\n    try {\n      setLoadingTasks(true);\n      console.log(`Fetching tasks for epic ${epicId}...`);\n      \n      const response = await fetch(`/tasks/epic/${epicId}`);\n      if (!response.ok) {\n        throw new Error('Failed to fetch tasks for epic');\n      }\n\n      const epicTasks = await response.json();\n      console.log(`Found ${epicTasks.length} tasks for epic ${epicId}:`, epicTasks);\n      setTasks(epicTasks);\n    } catch (error) {\n      console.error('Error fetching tasks for epic:', error);\n      setTasks([]);\n    } finally {\n      setLoadingTasks(false);\n    }\n  };\n\n  const handleEpicClick = () => {\n    onToggleExpand(epicId);\n  };\n\n  const handleTaskToggle = (taskId) => {\n    const newExpanded = new Set(expandedTasks);\n    if (newExpanded.has(taskId)) {\n      newExpanded.delete(taskId);\n    } else {\n      newExpanded.add(taskId);\n    }\n    setExpandedTasks(newExpanded);\n  };\n\n  const handleEdit = () => {\n    navigate(\"/edit-epic\", { state: { epic: epic } });\n  };\n\n  const handleDelete = () => {\n    onDeleteTask(epic);\n  };\n\n  const handleAddTask = () => {\n    navigate(`/add-task/${epicId}`);\n  };\n\n  const getEpicTitle = () => {\n    return epic.title || epic.name || 'Untitled Epic';\n  };\n\n  const getEpicType = () => {\n    return epic.type || 'epic';\n  };\n\n  return (\n    <>\n      {/* Epic Row */}\n      <tr className=\"epic-row\">\n        <td className=\"expand-column\">\n          <button\n            className={`expand-button ${isExpanded ? 'expanded' : ''}`}\n            onClick={handleEpicClick}\n            title={isExpanded ? 'Collapse' : 'Expand'}\n          >\n            {isExpanded ? '▼' : '▶'}\n          </button>\n        </td>\n        <td className=\"epic-title\">\n          <strong>{getEpicTitle()}</strong>\n          <button \n            onClick={handleAddTask}\n            className=\"add-task-btn\"\n            title=\"Add Task\"\n            style={{ marginLeft: '10px', fontSize: '14px', padding: '2px 6px' }}\n          >\n            + Add Task\n          </button>\n        </td>\n        <td>\n          <span className=\"type-badge epic-badge\">{getEpicType()}</span>\n        </td>\n        <td>{epic.status || 'Not Started'}</td>\n        <td>{epic.priority || 'Medium'}</td>\n        <td>{epic.assigneeId || epic.assignedTo || 'Unassigned'}</td>\n        <td>{epic.startDate}</td>\n        <td>{epic.endDate || epic.dueDate || 'N/A'}</td>\n        <td>\n          <div className=\"button-container\">\n            <button onClick={handleEdit} className=\"button-list edit-btn\">Edit</button>\n            <button onClick={handleDelete} className=\"button-list delete-btn\">Delete</button>\n          </div>\n        </td>\n      </tr>\n\n      {/* Expanded Tasks */}\n      {isExpanded && (\n        <>\n          {loadingTasks ? (\n            <tr className=\"loading-row\">\n              <td colSpan=\"9\" className=\"loading-cell\">\n                Loading tasks for epic...\n              </td>\n            </tr>\n          ) : tasks.length === 0 ? (\n            <tr className=\"empty-row\">\n              <td colSpan=\"9\" className=\"empty-cell\">\n                No tasks found under this epic.\n              </td>\n            </tr>\n          ) : (\n            tasks.map((task) => (\n              <TaskRow\n                key={task.id || task.taskId}\n                task={task}\n                level={1}\n                isExpanded={expandedTasks.has(task.id || task.taskId)}\n                onToggleExpand={handleTaskToggle}\n                onDeleteTask={onDeleteTask}\n                refreshTrigger={refreshTrigger}\n              />\n            ))\n          )}\n        </>\n      )}\n    </>\n  );\n};\n\nexport default EpicRow;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}